<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>CGDContract (Netlify Proxy)</title>
  <style>
    body{font-family:system-ui, sans-serif; margin:24px}
    label{display:inline-block; width:120px}
    input{padding:6px 8px; margin:4px 0}
    button{padding:8px 12px; margin-top:8px}
    pre{white-space:pre-wrap; word-break:break-word; background:#f6f6f6; padding:12px; border-radius:8px}
  </style>
</head>
<body>
  <h2>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ CGDContract (‡∏õ‡∏µ + keyword, limit=20)</h2>

  <div>
    <label>‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:</label>
    <input id="year" type="number" value="2568">
  </div>
  <div>
    <label>Keyword:</label>
    <input id="keyword" type="text" value="‡∏û‡∏≤‡∏´‡∏ô‡∏∞">
  </div>
  <div>
    <label>Limit:</label>
    <input id="limit" type="number" value="20" min="1" max="1000">
  </div>

  <button id="btn">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>

  <h3>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h3>
  <pre id="out">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</pre>

<script>
document.getElementById('btn').addEventListener('click', async () => {
  const year = document.getElementById('year').value || '2568';
  const keyword = document.getElementById('keyword').value || '';
  const limit = document.getElementById('limit').value || '20';

  // ‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å path ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÑ‡∏°‡πà‡∏°‡∏µ path= ‡πÉ‡∏´‡πâ‡∏´‡∏•‡∏∏‡∏î‡πÑ‡∏õ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á
  const qs = new URLSearchParams({ year, keyword, limit });
  const url = '/api/cgdcontract?' + qs.toString();

  const out = document.getElementById('out');
  out.textContent = 'GET ' + url + '\n\n‚è≥ ‡πÇ‡∏´‡∏•‡∏î...';

  try {
    const res = await fetch(url, { headers: { 'Accept': 'application/json' }});
    const text = await res.text();
    // ‡πÅ‡∏™‡∏î‡∏á‡∏î‡∏¥‡∏ö ‡πÜ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô JSON ‡∏Å‡πá‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢
    out.textContent = 'HTTP ' + res.status + ' ' + res.statusText + '\n\n' + text;
  } catch (e) {
    out.textContent = '‚ùå ' + e;
  }
});
</script>
</body>
</html>